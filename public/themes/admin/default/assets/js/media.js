var Media=function(){var e={AddMedia:function(){$(".input-add-media").bind("change",function(){if(0!==$(this).get(0).files.length){$(".btn-add-media").css("display","block");var e=$(".input-add-media").prop("files")[0],a=new FormData;a.append("pictures",e);var t=(window.URL?URL:webkitURL).createObjectURL(e);$(".form-add-media").before('<span class="image_name">'+e.name+"</span>"),$(".form-add-media").parent(".card-body").before('<img class="card-img-top img_form_upload_card" src="'+t+'" alt="Card image cap">'),$(".form-add-media").submit(function(t){return t.preventDefault(),$.ajax({beforeSend:function(e,a){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(a.type)||e.setRequestHeader("X-CSRFToken",$('meta[name="_token"]').attr("content"))},method:"POST",url:App.GetBaseUrl()+"admin/ajax/media/add",data:a,dataType:"json",cache:!1,processData:!1,contentType:!1,success:function(t){1==t.code?($(".col-add-media").after('<div class="col-sm-2">\n                        <div class="card mb-3">\n                            <img class="card-img-top" src="'+App.GetBaseUrl()+"/"+t.slug+'" alt="Card image cap">\n                            <div class="card-body">\n                                <h4 class="card-title">'+e.name+'</h4>\n                                <p class="card-text" style="text-align: center">\n                                    <span class="btn btn-danger remove_img" data-mediaid="'+t.id+'" data-medianame="'+e.name+'" data-mediaslug="/'+t.slug+'" style="margin-left: auto;margin-right: auto;">Delete</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>'),$(".image_name").remove(),$(".img_form_upload_card").remove(),$(".btn-add-media").css("display","none"),a.delete("pictures"),App.NotifToast("success",t.title,t.message)):App.NotifToast("error","Erreur",t.message)},error:function(e){App.NotifToast("error","Erreur",e.responseText)}}),!1})}})},removeMedia:function(e){var a=e.data("mediaid"),t=e.data("mediaslug"),n=e.data("medianame");$.ajax({beforeSend:function(e,a){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(a.type)||e.setRequestHeader("X-CSRFToken",$('meta[name="_token"]').attr("content"))},method:"POST",url:App.GetBaseUrl()+"admin/ajax/media/remove",data:{id:a,slug:t,name:n},dataType:"json",cache:!1,success:function(a){(a.code=1)?(e.parents(".col-sm-2").remove(),App.NotifToast("success",a.title,a.message)):App.NotifToast("error","Erreur",a.message)},error:function(e){console.error(e.responseText)}})},init:function(){e.AddMedia(),$(".remove_img").click(function(a){return a.preventDefault(),e.removeMedia($(this)),!1})}};return e}();$(document).ready(function(){Media.init()});