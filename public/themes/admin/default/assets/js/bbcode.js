var BBCode=function(){var e={insertTag:function(e,a,t,n){var i=n,r=(i.val().length,i[0].selectionStart),o=i[0].selectionEnd,d=e+i.val().substring(r,o)+a;i.val(i.val().substring(0,r)+d+i.val().substring(o))},media:function(a){$.ajax({beforeSend:function(e,a){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(a.type)||e.setRequestHeader("X-CSRFToken",$('meta[name="_token"]').attr("content"))},method:"POST",url:App.GetBaseUrl()+"admin/ajax/media/modal",data:{type_modal:"bbcode"},dataType:"json",cache:!1,success:function(t){$("body").append(t.content),$(".modal-media_bbcode").modal("show"),$(".modal-media_bbcode").on("shown.bs.modal",function(t){$(".input-add-media").bind("change",function(){if(0!==$(this).get(0).files.length){$(".btn-add-media").css("display","block");var e=$(".input-add-media").prop("files")[0],a=new FormData;a.append("pictures",e);var t=(window.URL?URL:webkitURL).createObjectURL(e);$(".form-add-media").before(e.name),$(".form-add-media").parent(".card-body").before('<img class="card-img-top" src="'+t+'" alt="Card image cap">'),$(".form-add-media").submit(function(t){return t.preventDefault(),$.ajax({beforeSend:function(e,a){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(a.type)||e.setRequestHeader("X-CSRFToken",$('meta[name="_token"]').attr("content"))},method:"POST",url:App.GetBaseUrl()+"admin/ajax/media/add",data:a,dataType:"json",cache:!1,processData:!1,contentType:!1,success:function(t){1==t.code?($(".col-add-media").after('<div class="col-sm-2">\n                        <div class="card mb-3">\n                            <img class="card-img-top" src="'+App.GetBaseUrl()+"/"+t.slug+'" alt="Card image cap">\n                            <div class="card-body">\n                                <h4 class="card-title">'+e.name+'</h4>\n                                <p class="card-text" style="text-align: center">\n                                    <span class="btn btn-secondary choice_img_bbcode" data-mediaid="'+t.id+'" data-mediaslug="'+App.GetBaseUrl()+"/"+t.slug+'" style="margin-left: auto;margin-right: auto;">Choisir</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>'),$(".image_name").remove(),$(".img_form_upload_card").remove(),$(".btn-add-media").css("display","none"),a.delete("pictures"),App.NotifToast("success",t.title,t.message)):App.NotifToast("error","Erreur",t.message)},error:function(e){App.NotifToast("error","Erreur",e.responseText)}}),!1})}}),$(".choice_img_bbcode").click(function(){e.insertTag('[img id="'+$(this).data("mediaid")+'" width="0" height="0"]',"","image",a)})}),$(".modal-media_bbcode").on("hidden.bs.modal",function(e){$(".modal-media_bbcode").remove()})},error:function(e){console.log(e.responseText)}})},color:function(a){$("#mycp").spectrum({showInput:!0,allowEmpty:!0,color:"#f00000",change:function(t){console.log(t.toHexString()),e.insertTag('[color="'+t.toHexString()+'"]',"[/color]","color",a)}})},init:function(){var a=$(".form-redac").find("button"),t=$(".form-redac").find("textarea");e.color(t),a.click(function(){switch($(this).data("type")){case"bold":e.insertTag("[b]","[/b]","bold",t);break;case"italic":e.insertTag("[i]","[/i]","italic",t);break;case"del":e.insertTag("[del]","[/del]","del",t);break;case"underline":e.insertTag("[u]","[/u]","underligne",t);break;case"quote":e.insertTag("[quote]","[/quote]","underligne",t);break;case"header":var a=$(this).data("header");e.insertTag('[header="'+a+'"]',"[/header]","header",t);break;case"align":var n=$(this).data("align");e.insertTag('[align="'+n+'"]',"[/align]","align",t);break;case"link":e.insertTag('[link=""]',"[/link]","link",t);break;case"code":var i=$(this).data("code");e.insertTag('[code="'+i+'"]',"[/code]","code",t);break;case"alert":var r=$(this).data("alert");e.insertTag('[alert="'+r+'"]',"[/alert]","alert",t);break;case"media":e.media(t);break;case"youtube":e.insertTag("[youtube]","[/youtube]","youtube",t);break;case"source":e.insertTag('[source url=""]',"[/source]","source",t)}})}};return e}();