var Page=function(){var e={TitleToLink:function(){var e=$("#title"),a=$("#link");e.bind("change paste keyup",function(){for(var t=[/[\300-\306]/g,/[\340-\346]/g,/[\310-\313]/g,/[\350-\353]/g,/[\314-\317]/g,/[\354-\357]/g,/[\322-\330]/g,/[\362-\370]/g,/[\331-\334]/g,/[\371-\374]/g,/[\321]/g,/[\361]/g,/[\307]/g,/[\347]/g],i=["A","a","E","e","I","i","O","o","U","u","N","n","C","c"],n=e.val(),s=0;s<t.length;s++)n=n.replace(t[s],i[s]);n=(n=(n=n.replace(/'/g,"")).replace(/"/g,"")).replace(/ /g,"-"),a.val(n)})},AddPage:function(){$(".add_page_form").submit(function(e){e.preventDefault();var a=$("#title"),t=$("#link"),i=$("#content"),n=$("input[name=options]:checked").val(),s=null;return a.val()?a.addClass("is-valid"):(s=!0,a.addClass("is-invalid"),setTimeout(function(){a.removeClass("is-invalid")},1500)),t.val()?t.addClass("is-valid"):(s=!0,t.addClass("is-invalid"),setTimeout(function(){t.removeClass("is-invalid")},1500)),i.val()?i.addClass("is-valid"):(s=!0,i.addClass("is-invalid"),setTimeout(function(){i.removeClass("is-invalid")},1500)),null==s&&$.ajax({beforeSend:function(e,a){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(a.type)||e.setRequestHeader("X-CSRFToken",$('meta[name="_token"]').attr("content"))},method:"POST",url:App.GetBaseUrl()+"admin/ajax/page/add",data:{title:a.val(),link:t.val(),content:i.val(),active:n},dataType:"json",cache:!1,success:function(e){(e.code=1)?App.NotifToast("success",e.title,e.message):App.NotifToast("error","Erreur",e.message)},error:function(e){console.log(e.responseText)}}),!1})},EditPage:function(){$(".edit_page_form").submit(function(e){e.preventDefault();var a=$(this).data("pageid"),t=$("#title"),i=$("#link"),n=$("#content"),s=$("input[name=options]:checked").val(),l=null;return t.val()?t.addClass("is-valid"):(l=!0,t.addClass("is-invalid"),setTimeout(function(){t.removeClass("is-invalid")},1500)),i.val()?i.addClass("is-valid"):(l=!0,i.addClass("is-invalid"),setTimeout(function(){i.removeClass("is-invalid")},1500)),n.val()?n.addClass("is-valid"):(l=!0,n.addClass("is-invalid"),setTimeout(function(){n.removeClass("is-invalid")},1500)),null==l&&$.ajax({beforeSend:function(e,a){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(a.type)||e.setRequestHeader("X-CSRFToken",$('meta[name="_token"]').attr("content"))},method:"POST",url:App.GetBaseUrl()+"admin/ajax/page/edit",data:{pageid:a,title:t.val(),link:i.val(),content:n.val(),active:s},dataType:"json",cache:!1,success:function(e){(e.code=1)?App.NotifToast("success",e.title,e.message):App.NotifToast("error","Erreur",e.message)},error:function(e){console.log(e.responseText)}}),!1})},init:function(){BBCode.init(),e.TitleToLink(),e.AddPage(),e.EditPage()}};return e}();$(document).ready(function(){Page.init()});